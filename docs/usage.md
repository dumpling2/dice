# Discord ダイスボットの使用方法

## ファイル構造

ダイスボットは以下のモジュール構造で構成されています：

```
dice/
├── src/                 # ソースコード
│   ├── dice/            # ダイスロールの中核ロジック
│   │   ├── parser.py    # ダイス表記の解析
│   │   ├── roller.py    # ダイスロール実行
│   │   └── renderer.py  # 結果表示
│   ├── commands/        # コマンド処理
│   │   ├── roll.py      # ロールコマンド
│   │   └── history.py   # 履歴コマンド
│   ├── utils/           # ユーティリティ
│   │   └── logger.py    # ロギング
│   └── views/           # UI要素
│       └── dice_view.py # ダイスUI
├── config/              # 設定
│   └── settings.py      # 設定管理
└── main.py              # ランチャー
```

## 使用方法

### ボットの起動

```bash
# 通常モードで起動
python dice/main.py

# デバッグモードで起動（詳細なログ出力）
python dice/main.py --debug
```

### 環境変数の設定

初回実行時に`.env`ファイルが自動的に作成されます。このファイルを編集してDiscord Botトークンを設定してください：

```
# Discord Bot Token - 実際のトークンに置き換えてください
DISCORD_BOT_TOKEN=your_bot_token_here

# コマンドプレフィックス設定（デフォルト: !）
COMMAND_PREFIX=!

# ロギングレベル（INFO/DEBUG/WARNING/ERROR）
LOG_LEVEL=INFO
```

## コマンド一覧

ボットが起動したら、以下のコマンドが使用できます：

### ダイスロールコマンド

- **基本的なダイスロール**:
  ```
  !roll d20        # 20面ダイスを1個振る
  !roll 2d6        # 6面ダイスを2個振る
  ```

- **修正値付きロール**:
  ```
  !roll 1d20+5     # 20面ダイスを振り、結果に5を加える
  !roll 2d6-3      # 6面ダイスを2個振り、結果から3を引く
  ```

- **複数種類のダイス**:
  ```
  !roll 1d20+2d4   # 20面ダイス1個と4面ダイス2個を振る
  !roll 2d8+1d6+3  # 8面ダイス2個と6面ダイス1個を振り、3を加える
  ```

- **ヘルプの表示**:
  ```
  !roll help       # ヘルプメッセージを表示
  ```

### 履歴コマンド

- **ロール履歴の表示**:
  ```
  !history         # あなたの過去10回分のダイスロール履歴を表示
  ```

## 特殊機能

### クリティカル/ファンブル判定

各ダイスがそれぞれ最大値（クリティカル）または最小値（ファンブル）の場合、特別な結果として表示されます。

- **クリティカル**: すべてのダイスが最大値（例：d20で20、2d6で両方6）
- **ファンブル**: すべてのダイスが最小値（例：d20で1、2d6で両方1）

### インタラクティブな再ロール

ダイスロール結果には「再ロール」ボタンが表示されます。このボタンをクリックすると、同じ種類のダイスを再度振ることができます。

## 制限事項

- **ダイスの数**: 1〜100個
- **ダイスの面数**: 2〜1000面
- **修正値**: -1000〜1000

## エラー処理

無効なダイス表記や制限を超えるリクエストを送信した場合、ボットはエラーメッセージを返します。例：

- 無効なダイス表記: `!roll abc`
- 範囲外のダイス数: `!roll 200d6`
- 範囲外の面数: `!roll 1d1` または `!roll 1d2000` 