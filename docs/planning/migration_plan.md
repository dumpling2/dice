# Discord ダイスボット コード移行計画

このドキュメントでは、既存のダイスボットコードをモジュール化された新しい構造に移行するための詳細な計画を提供します。

## 移行の目標

1. **モジュール化** - コードを論理的なモジュールに分割
2. **責任の分離** - 各モジュールに明確な責任を持たせる
3. **拡張性の向上** - 新機能を追加しやすい構造を作る
4. **テスト容易性の向上** - 各モジュールを独立してテスト可能にする
5. **コード品質の向上** - 一貫性のあるコードスタイルと適切なドキュメントを実現

## 移行手順

### 1. ファイル構造の作成

```
dice/
├── src/                 # ソースコード
│   ├── dice/            # ダイスロールの中核ロジック
│   ├── commands/        # コマンド処理
│   ├── utils/           # ユーティリティ
│   └── views/           # UI要素
├── config/              # 設定
├── tests/               # テストコード
└── main.py              # ランチャー
```

### 2. 中核モジュールの実装

#### src/utils/logger.py

ロギングユーティリティを実装します。

#### config/settings.py

設定管理モジュールを実装します。

#### src/dice/parser.py

ダイス表記パーサーを実装します。

#### src/dice/roller.py

ダイスロールエンジンを実装します。

#### src/dice/renderer.py

結果表示ロジックを実装します。

### 3. コマンドとUIの実装

#### src/views/dice_view.py

Discord UIコンポーネントを実装します。

#### src/commands/roll.py

ロールコマンドを実装します。

#### src/commands/history.py

履歴コマンドを実装します。

### 4. 統合

#### src/bot.py

メインボットアプリケーションを実装します。

#### main.py

ランチャースクリプトを実装します。

### 5. テスト

各モジュールに対応するテストを `tests/` ディレクトリに実装します。

## 結論

このモジュール化アプローチにより、以下の利点があります：

1. **コード検索の容易さ** - Cursor IDEで関連コードを簡単に見つけられる
2. **コード補完の改善** - IDEがモジュール構造を理解しやすくなる
3. **メンテナンス性の向上** - 責任範囲が明確になる
4. **並行開発の容易さ** - 異なるモジュールを異なる開発者が同時に作業できる
5. **テスト容易性** - モジュール単位でテスト可能になる 